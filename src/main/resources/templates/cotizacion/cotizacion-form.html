<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario Cotización</title>
</head>
<body>

<h1 th:text="${cotizacion.idCotizacion == null ? 'Nueva Cotización' : 'Editar Cotización'}"></h1>

<a href="/cotizaciones">⬅ Volver</a>
<br><br>

<p th:if="${error}" th:text="${error}" style="color:red;"></p>

<form action="/cotizaciones/guardar" method="post">

    <input type="hidden" name="idCotizacion" th:value="${cotizacion.idCotizacion}">

    <label>Número:</label><br>
    <input type="text" name="numeroCotizacion" th:value="${cotizacion.numeroCotizacion}" required>
    <br><br>

    <label>Validez (días):</label><br>
    <input type="number" name="validezDias" th:value="${cotizacion.validezDias}" required>
    <br><br>

    <label>Subtotal Repuestos:</label><br>
    <input type="number" step="0.01" name="subtotalRepuestos" th:value="${cotizacion.subtotalRepuestos}">
    <br><br>

    <label>Subtotal Mano de Obra:</label><br>
    <input type="number" step="0.01" name="subtotalManoObra" th:value="${cotizacion.subtotalManoObra}">
    <br><br>

    <label>Estado:</label><br>
    <select name="estado" required>
        <option th:value="PENDIENTE" th:selected="${cotizacion.estado == 'PENDIENTE'}">PENDIENTE</option>
        <option th:value="APROBADA" th:selected="${cotizacion.estado == 'APROBADA'}">APROBADA</option>
        <option th:value="RECHAZADA" th:selected="${cotizacion.estado == 'RECHAZADA'}">RECHAZADA</option>
        <option th:value="VENCIDA" th:selected="${cotizacion.estado == 'VENCIDA'}">VENCIDA</option>
    </select>
    <br><br>

    <label>Orden de Trabajo:</label><br>
    <select name="idOrdenTrabajo" required>
        <option value="">-- Seleccione --</option>

        <option th:each="ord : ${ordenes}"
                th:value="${ord.idOrdenTrabajo}"
                th:selected="${cotizacion.ordenTrabajo != null && cotizacion.ordenTrabajo.idOrdenTrabajo == ord.idOrdenTrabajo}"
                th:text="${'OT-' + ord.idOrdenTrabajo}">
        </option>
    </select>

    <br><br>

    <label>Observaciones:</label><br>
    <textarea name="observaciones" th:text="${cotizacion.observaciones}"></textarea>
    <br><br>

    <button type="submit">Guardar</button>

</form>

</body>
</html>
